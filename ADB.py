#!/usr/bin/python3

import subprocess

devices = subprocess.run(
    "adb devices | awk {'print $1'} | grep -v -E 'List'", capture_output=True, shell=True, text=True)
ip = str(devices.stdout).split("\n")
wifi, serials, Index_adb = [], [], None
for x in ip:
    if x == "":
        pass
    else:
        if "." in x:
            wifi.append(x)
        else:
            serials.append(x)
a = subprocess.run(
    "adb devices -l | grep -v ^$ | awk {'if(NR>1) print $0'}", shell=True, capture_output=True)
print(a.stdout.decode(), end="")
print()
ID = input("Enter the ip address( public or private )  or serial number :")
Index_adb = input('''\n
press 1 to install the apk in mobile
press 2 to uninstall the app from the mobile
press 3 to see installed application
press 4 to connect USB devices to wireless tcp
press 5 to see packages file path where the apk is present''')

if Index_adb == "1":
    apk_path = input("Enter the path where the apk is present :")
    subprocess.run("adb -s {0} install {1}".format(ID, apk_path), shell=True)

elif Index_adb == "2":
    package_name = input("Enter the package name :")
    subprocess.run(
        "adb -s {0} uninstall {1}".format(ID, package_name), shell=True)

elif Index_adb == "3":
    subprocess.run("adb -s {0} shell pm list packages".format(ID), shell=True)

elif Index_adb == "4":
    subprocess.run("adb -s {0} tcpip 5555".format(ID), shell=True)
    print("To check the IP rerun this program and press 2")

elif Index_adb == "5":
    subprocess.run(
        "adb -s {0} shell pm list packages -f".format(ID), shell=True)

elif Index_adb == "6":
    subprocess.run("adb -s {0} shell reboot".format(ID), shell=True)

elif Index_adb == "7":
    subprocess.run(
        "adb -s {0} shell ip -f inet addr show | grep inet | cut -d' ' -f6 | cut -d '/' -f 1".format(ID), shell=True)

elif Index_adb == "8":
    subprocess.run("adb kill-server", shell=True)

elif Index_adb == "9":
    subprocess.run("adb start-server", shell=True)

elif Index_adb == "10":
    subprocess.run(
        "adb -s {0} shell getprop ro.build.version.release".format(ID), shell=True)

elif Index_adb == "11":
    print("Note : '\\' not present in source path, If the destination path is not set it takes /sdcard as default")
    source_path = input("Enter the source path :")
    destination_path = input("Enter the destination path :")
    if destination_path == "":
        destination_path = "/sdcard"
    subprocess.run("adb -s {0} push {1} {2}".format(ID,
                                                    source_path, destination_path), shell=True)

elif Index_adb == "12":
    print("Note : '\\' not present in destination path, If the destination path is not set it takes download folder as default")
    source_path = input("Enter the source path :")
    destination_path = input("Enter the destination path :")
    if destination_path == "":
        whoami = subprocess.run("whoami", shell=True,
                                capture_output=True, text=True)
        destination_path = "/home/{0}/Downloads/".format(
            whoami.stdout).split("\n")
        destination_path = destination_path[0]+destination_path[1]
    subprocess.run("adb -s {0} pull {1} {2}".format(ID,
                                                    source_path, destination_path), shell=True)

elif Index_adb == "13":
    package_name = input("Enter the package name :")
    subprocess.run(
        "adb -s {0} shell pm clear {1}".format(ID, package_name), shell=True)

elif Index_adb == "14":
    package_name = input("Enter the package name :")
    subprocess.run(
        "adb -s {0} shell pm hide {1}".format(ID, package_name), shell=True)

elif Index_adb == "15":
    package_name = input("Enter the package name :")
    subprocess.run(
        "adb -s {0} shell pm unhide {1}".format(ID, package_name), shell=True)
