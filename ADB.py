#!/usr/bin/python3

import subprocess

devices = subprocess.run("adb devices | awk {'print $1'} | grep -v -E 'List'",capture_output = True, shell = True, text = True)
ip = str(devices.stdout).split("\n")
wifi,serials,Index_adb = [],[],None
for x in ip:
    if x == "":
        pass
    else:
        if "." in x:
            wifi.append(x)
        else:
            serials.append(x)
a = subprocess.run("adb devices -l | grep -v ^$ | awk {'if(NR>1) print $0'}", shell= True ,capture_output = True)
print(a.stdout.decode(),end = "")
print( )
ID = input("Enter the ip address or serial number :")
Index_adb=input('''\n
press 1 to install the apk in mobile
press 2 to uninstall the app from the mobile
press 3 to see installed application
press 4 to connect USB devices to wireless tcp
press 5 to see packages file path where the apk is present''')

if Index_adb == "1":
    apk_path = input("Enter the path where the apk is present :")
    subprocess.run("adb -s {0} install {1}".format(ID,apk_path),shell = True)

elif Index_adb == "2":
    package_name = input("Enter the package name :")
    subprocess.run("adb -s {0} uninstall {1}".format(ID,package_name),shell=True)

elif Index_adb == "3":
    subprocess.run("adb -s {0} shell pm list packages".format(ID),shell=True)

elif Index_adb == "4":
    subprocess.run("adb -s {0} tcpip 5555".format(ID),shell=True)
    print("To check the IP rerun this program and press 2")

elif Index_adb == "5":
    subprocess.run("adb -s {0} shell pm list packages -f".format(ID),shell=True)
